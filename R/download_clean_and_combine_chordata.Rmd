```{r}
library(raster)
library(ALA4R)
library(readr)
library(tidyr)
library(dplyr)
library(rnaturalearth)
library(rgeos)
library(sp)
library(rgdal)
```


Set ALA4R cache directory
```{r}
ala_config(cache_directory='c:/data/ala_cache_2017', download_reason_id=7)
```

```{r}
aus_states <- spTransform(ne_states(country='Australia'), CRS('+init=epsg:3577'))
aus <- spTransform(ne_countries(10, country='Australia'), CRS('+init=epsg:3577'))
aus_buffer <- gBuffer(aus, width=10000)
```

Some names have changed in ALA (e.g. prolific addition of subgenus (?) in
names). Need to create a lookup table so we can keep track of which species
names relate to each other.


```{r}
spp <- data.frame(
  phase1_2016=gsub('_', ' ', basename(
  list.dirs('../sdms_1km_2016/output/chordata', recursive=FALSE))),
  phase1_2017='',
  stringsAsFactors=FALSE)

dput(spp$phase1_2016)
# c("Aepyprymnus rufescens", "Alectura lathami", "Antechinomys laniger", 
#   "Antechinus agilis", "Antechinus flavipes", "Antechinus swainsonii", 
#   "Aprasia inaurita", "Aprasia parapulchella", "Atrichornis rufescens", 
#   "Botaurus poiciloptilus", "Burhinus grallarius", "Callocephalon fimbriatum", 
#   "Calyptorhynchus lathami", "Cercartetus nanus", "Certhionyx variegatus", 
#   "Chthonicola sagittata", "Cinclosoma castanotum", "Circus assimilis", 
#   "Coeranoscincus reticulatus", "Coracina lineata", "Corcorax melanorhamphos", 
#   "Cyclodomorphus melanops elongatus", "Cyclodomorphus praealtus", 
#   "Cyclospitta diophthalma coxeni", "Daphoenositta chrysoptera", 
#   "Dasyornis brachypterus", "Dasyurus maculatus", "Delma australis", 
#   "Delma impar", "Elseya belli", "Epthianura albifrons", "Eulamprus leuraensis", 
#   "Falco subniger", "Falsistrellus tasmaniensis", "Glossopsitta pusilla", 
#   "Grantiella picta", "Heleioporus australiacus", "Hieraaetus morphnoides", 
#   "Hoplocephalus bitorquatus", "Hoplocephalus stephensii", "Hylacola cautus", 
#   "Irediparra gallinacea", "Isoodon macrourus", "Ixobrychus flavicollis", 
#   "Kerivoula papuensis", "Lathamus discolor", "Leucosarcia melanoleuca", 
#   "Litoria brevipalmata", "Litoria daviesae", "Litoria littlejohni", 
#   "Litoria olongburensis", "Litoria subglandulosa", "Lophochroa leadbeateri", 
#   "Lophoictinia isura", "Macropus giganteus", "Macropus parma", 
#   "Macropus rufogriseus", "Menura alberti", "Menura novaehollandiae", 
#   "Miniopterus australis", "Mixophyes balbus", "Mixophyes iteratus", 
#   "Morethia boulengeri", "Myotis macropus", "Neophema pulchella", 
#   "Ningaui yvonneae", "Ninox connivens", "Ninox strenua", "Nyctophilus corbeni", 
#   "Oxyura australis", "Pachycephala inornata", "Pachycephala olivacea", 
#   "Pandion cristatus", "Perameles nasuta", "Petaurus australis", 
#   "Petaurus norfolcensis", "Petroica boodang", "Petroica phoenicea", 
#   "Phascogale tapoatafa", "Philoria loveridgei", "Philoria sphagnicola", 
#   "Podargus ocellatus", "Polytelis swainsonii", "Pseudophryne australis", 
#   "Pteropus poliocephalus", "Ptilinopus regina", "Pyrrholaemus brunneus", 
#   "Saccolaimus flaviventris", "Scoteanax rueppellii", "Simoselaps fasciolatus", 
#   "Sminthopsis leucopus", "Sminthopsis macroura", "Stagonopleura guttata", 
#   "Stictonetta naevosa", "Tachyglossus aculeatus", "Thylogale stigmatica", 
#   "Thylogale thetis", "Tiliqua occipitalis", "Trichosurus caninus", 
#   "Trichosurus vulpecula", "Tyto longimembris", "Tyto novaehollandiae", 
#   "Tyto tenebricosa tenebricosa", "Uvidicolus sphyrurus", "Varanus rosenbergi", 
#   "Vespadelus troughtoni", "Vombatus ursinus hirsutus", "Wallabia bicolor"
# )

spp_names <- search_names(spp$phase1_2016)

# spp$phase1_2017[which(spp_names$searchTerm == spp_names$name)] <-
#   spp$phase1_2016[which(spp_names$searchTerm == spp_names$name)]

spp$phase1_2017[which(spp_names$searchTerm == sub('(.+) \\([^\\)]+) (.+)', '\\1 \\2', spp_names$name))] <-
  spp$phase1_2016[which(spp_names$searchTerm == sub('(.+) \\([^\\)]+) (.+)', '\\1 \\2', spp_names$name))]

filter(spp, phase1_2017=='')

spp_names %>% filter(searchTerm != name | is.na(name))

filter(spp_names, searchTerm != sub('(.+) \\([^\\)]+) (.+)', '\\1 \\2', name) | is.na(name))
# Some names match incorrectly to subspecies. Fix genus name as per ALA.
# Other names don't match at all, or have typos... fix all this!

## 'Cinclosoma castanotum' = 'Cinclosoma (Malleeavis) castanotum'
## 'Coracina lineata' = 'Coracina (Paragraucalus) lineata'
## 'Cyclospitta diophthalma coxeni' = 'Cyclospitta diophthalma coxeni' AND 'Cyclopsitta diopthalma coxeni'
## 'Daphoenositta chrysoptera' = 'Daphoenositta (Neositta) chrysoptera'
## 'Falco subniger' = 'Falco (Hierofalco) subniger'
## 'Ninox connivens' = 'Ninox (Hieracoglaux) connivens'
## 'Ninox strenua' = 'Ninox (Rhabdoglaux) strenua'
## 'Pachycephala inornata' = 'Pachycephala (Timixos) inornata'
## 'Petroica phoenicea' = 'Petroica (Littlera) phoenicea'
## 'Tyto novaehollandiae' = 'Tyto (Megastrix) novaehollandiae'
## 'Tyto tenebricosa tenebricosa' = 'Tyto (Megastrix) tenebricosa tenebricosa'

# manually fix
fix1 <- matrix(c('Cinclosoma castanotum', 'Cinclosoma (Malleeavis) castanotum',
                'Coracina lineata', 'Coracina (Paragraucalus) lineata',
                'Cyclospitta diophthalma coxeni', 'Cyclopsitta diophthalma coxeni',
                'Daphoenositta chrysoptera', 'Daphoenositta (Neositta) chrysoptera',
                'Falco subniger', 'Falco (Hierofalco) subniger',
                'Ninox connivens', 'Ninox (Hieracoglaux) connivens',
                'Ninox strenua', 'Ninox (Rhabdoglaux) strenua',
                'Pachycephala inornata', 'Pachycephala (Timixos) inornata',
                'Petroica phoenicea', 'Petroica (Littlera) phoenicea',
                'Tyto novaehollandiae', 'Tyto (Megastrix) novaehollandiae',
                'Tyto tenebricosa tenebricosa', 'Tyto (Megastrix) tenebricosa tenebricosa'),
              ncol=2, byrow=TRUE)

spp$phase1_2017[match(fix1[, 1], spp$phase1_2016)] <- fix1[, 2]



# Also need to add "Cyclopsitta diopthalma coxeni" (there are two spellings for this species)
spp <- rbind(spp, c('Cyclospitta diophthalma coxeni', 'Cyclopsitta diopthalma coxeni')) %>% 
  arrange(phase1_2016)

# Add koala (not modelled in 2016, but has been added in 2017)
spp <- rbind(spp, c(NA, 'Phascolarctos cinereus')) %>% 
  arrange(phase1_2016)


spp_names <- search_names(spp$phase1_2017) %>% 
  mutate(commonName=sapply(commonName, paste, collapse=';'))


# record count
n <- setNames(sapply(spp_names$acceptedConceptGuid, function(guid) {
  message('Doing ', guid)
  occurrences(sprintf('taxon_concept_lsid:%s', guid), record_count_only=TRUE)
}), spp_names$acceptedConceptGuid)

# Check which species have few records
n[n < 100]
spp_names[spp_names$acceptedConceptGuid %in% names(n[n < 100]),]
# Check ALA website manually
# Elseya belli should be Wollumbinia belli
# Phascogale tapoatafa = Phascogale tapoatafa tapoatafa?? Check with OEH
# Alectura lathami = Alectura lathami lathami?? Check with OEH
# Petaurus australis = Petaurus australis australis?? Check with OEH
# Perameles nasuta = Perameles nasuta nasuta?? Check with OEH
# Vombatus ursinus hirsutus = Vombatus ursinus?
# 

# Modify spp vector and repeat above steps.
fix2 <- matrix(c('Elseya belli','Wollumbinia belli',
                'Phascogale tapoatafa','Phascogale tapoatafa tapoatafa',
                'Alectura lathami','Alectura lathami lathami',
                'Petaurus australis','Petaurus australis australis',
                'Perameles nasuta','Perameles nasuta nasuta',
                'Vombatus ursinus hirsutus','Vombatus ursinus'), ncol=2, byrow=TRUE)

spp$phase1_2017[match(fix2[, 1], spp$phase1_2017)] <- fix2[, 2]
spp <- arrange(spp, phase1_2017)
write.csv(spp, 'species_names.csv', row.names=FALSE)

spp_names <- search_names(spp$phase1_2017) %>% 
  mutate(commonName=sapply(commonName, paste, collapse=';'))

spp_names

# new record count
n <- setNames(sapply(spp_names$acceptedConceptGuid, function(guid) {
  message('Doing ', guid)
  occurrences(sprintf('taxon_concept_lsid:%s', guid), record_count_only=TRUE)
}), spp_names$acceptedConceptGuid)

# Check which species still have few records
n[n < 100]
spp_names[spp_names$acceptedConceptGuid %in% names(n[n < 100]),]

# Download records (commented out to save time on subsequent runs)
# occ <- setNames(lapply(spp_names$acceptedConceptGuid, function(guid) {
#   message('Doing ', guid)
#   occurrences(sprintf('taxon_concept_lsid:%s', guid))
# }), spp_names$acceptedConceptGuid)
#saveRDS(occ, 'data/occurrence/chordata/occ_ala_chordata_raw.rds')
occ <- readRDS('data/occurrence/chordata/occ_ala_chordata_raw.rds')
```

Separate data and metadata
```{r}
occ_data <- lapply(occ, '[[', 'data')
occ_meta <- lapply(occ, '[[', 'meta')
#Reduce(intersect, sapply(occ_data, names)) # set of fields that exist for all species
```

Check what entries exist for basis of record

```{r}
# basis <- lapply(sapply(occ_data, '[[', 'basisOfRecord'), table)
```


### Clean the data

create a function that cleans the ALA records. Below, we exclude observations 
that:
* are dated prior to 1950;
* lack coordinates (though if we used `fq='geospatial_kosher:true'` in our
`occurrences` request, this is unnecessary);
* have zero latitude or zero longitude;
* have coordinate uncertainty greater than 1000 m;
* have locality containing "zoo" (ignoring case);
* have the taxon identification issue "questionSpecies";
* for which the basis of record is a fossil specimen;
* exist in the collections "BioNet Atlas of NSW Wildlife" or "NSW Office of
Environment and Heritage BioNet Atlas of NSW Wildlife" (since we already have
these records from OEH); or
* are flagged as `occCultivatedEscapee`.

```{r}
clean_ala <- function(x) {
  yr <- ifelse(is.na(x$year) | x$year < 1950, 'year', '')
  coords1 <- is.na(x$longitude) | is.na(x$latitude) | x$longitude == '' | x$latitude == ''
  coords2 <- if('zeroLatitude' %in% names(x)) x$zeroLatitude else FALSE
  coords3 <- if('zeroLongitude' %in% names(x)) x$zeroLongitude else FALSE
  coords4 <- if('invertedCoordinates' %in% names(x)) x$invertedCoordinates else FALSE # could just flip them back though...
  coords <- ifelse(coords1|coords2|coords3|coords4, 'coords', '')
  
  coorduncert <- ifelse(!((x$coordinateUncertaintyInMetres <= 1000) | 
                         is.na(x$coordinateUncertaintyInMetres)),
                       'coorduncert', '')
  loc <- ifelse(grepl('\\bzoo\\b', x$locality, ignore.case=TRUE), 'locality', '')
  taxonid <- ifelse(x$taxonIdentificationIssue == 'questionSpecies', 
                   'taxonid', '')
  basis <- ifelse(x$basisOfRecord == 'FossilSpecimen', 'basis', '')
  bionet <- ifelse(x$collectionCode %in% c(
      'BioNet Atlas of NSW Wildlife', 
      'NSW Office of Environment and Heritage BioNet Atlas of NSW Wildlife'), 
      'bionet', '')
  cultiv_esc <- if('occCultivatedEscapee' %in% names(x)) {
    ifelse(x$occCultivatedEscapee, 'cultiv_esc', '') 
  } else ''
  
  reason <- gsub('^,+|(?<=,),+|,+$',
                 '',
                 paste(yr, coords, coorduncert, loc, taxonid, basis, bionet, cultiv_esc, sep=','),
                 perl=TRUE
  )
  x <- x %>% 
    mutate(exclude=ifelse(reason!='', TRUE, FALSE),
           reason=ifelse(exclude, reason, NA))
  x
}
```

We now apply the function to our list of datasets:

```{r}
occ_data_clean <- lapply(occ_data, clean_ala)
```


Reduce to smaller set of fields

```{r}
fields <- Reduce(intersect, lapply(occ_data_clean, names))
occ_data_clean_minimal <- lapply(occ_data_clean, function(x) {
    x[, c('id', 'matchTaxonConceptLsid', 'scientificName', 'locality', 
          'latitude', 'longitude', 'coordinateUncertaintyInMetres', 'year', 
          'month', 'eventDate', 'basisOfRecord', 'outlierForLayer', 
          'taxonIdentificationIssue', 'exclude', 'reason')]
})
```


Combine the two _Cyclopsitta dopthalma coxeni_ datasets

```{r}
occ_data_clean_minimal$`urn:lsid:biodiversity.org.au:afd.taxon:af726a03-020b-41f8-941b-b15a5141ec52` <-
  rbind(occ_data_clean_minimal$`urn:lsid:biodiversity.org.au:afd.taxon:af726a03-020b-41f8-941b-b15a5141ec52`,
        occ_data_clean_minimal$`ALA_Cyclopsitta_diopthalma_coxeni`)
occ_data_clean_minimal <- occ_data_clean_minimal[names(occ_data_clean_minimal)!='ALA_Cyclopsitta_diopthalma_coxeni']
spp_names <- spp_names[!spp_names$acceptedConceptGuid=='ALA_Cyclopsitta_diopthalma_coxeni', ]
```

Add raw data sample size to `spp_names`.

```{r}
spp_names$nrecords_ala_raw <- sapply(occ_data_clean_minimal, nrow)[
  match(spp_names$acceptedConceptGuid, names(sapply(occ_data_clean_minimal, nrow)))]
```

Convert to SPDFs, project to 3577, and drop any records that aren't in
`aus_buffer` (i.e., within 10 km of Australian coastline)

```{r}
occ_data_clean_minimal_sp <- lapply(occ_data_clean_minimal, function(x) {
  message('Doing ', x[1, 'scientificName'])
  x <- filter(x, !grepl('coords', reason))
  coordinates(x) <- ~longitude+latitude
  proj4string(x) <- '+init=epsg:4326'
  x <- spTransform(x, CRS('+init=epsg:3577'))
  x <- crop(x, aus_buffer)
  o <- over(x, aus_buffer)
  x[which(o==1), ]
})
```


Calculate the number of records not flagged as `exclude` during cleaning

```{r}
n_ok <- sapply(occ_data_clean_minimal_sp, function(x) sum(!x$exclude))
spp_names$nrecords_ala_include <- n_ok
```

Write our `spp_names` for future reference

```{r}
write.csv(spp_names, 'animals_to_model.csv', row.names=FALSE)
spp_names <- read.csv('animals_to_model.csv', stringsAsFactors=FALSE)
```

Add pre-cleaned non-ALA records (incl. Bionet and Qld data sourced by Janeen
Robb)

```{r}
# occ_chordata <- '../sdms_1km_2016/data/occurrence/animal_occurrence_chordata_withJaneenData.rds' %>% 
#   readRDS %>%
#   as.data.frame %>% 
#   filter(nchar(record_id)!=36) %>% 
#   select(record_id, scientific_name, coordinate_uncertainty, year)
#   setNames(c('id'))


```


Make maps

```{r}
dir.create('data/occurrence/chordata/png')
dir.create('data/occurrence/chordata/shp')
sapply(spp_names$acceptedConceptGuid, function(guid) {
  i <- which(spp_names$acceptedConceptGuid==guid)
  nm <- spp_names$acceptedConceptName[i]
  # nm_simple <- sub('^([A-Z][a-z]+( \\([A-Z][a-z]+\\))? [^A-Z\\(]+).*', '\\1', nm)
  # nm_simple <- sub(' *$', '', nm_simple)
  common <- sub(';.*', '', spp_names$commonName[i])
  x <- occ_data_clean_minimal_sp[[guid]]
  f <- extension(spp_names$searchTerm[i], 'png')
  if(!file.exists(file.path('data/occurrence/chordata/png', f))) {
    png(file.path('data/occurrence/chordata/png', f), 8, 8, units='in', res=300, type='cairo')
    par(mar=c(0.5, 0.5, 5, 0.5))
    writeOGR(x, 'data/occurrence/chordata/shp', extension(f, ''), 'ESRI Shapefile')
    plot(subset(aus_states, !grepl('Island', name)),
         main=bquote(atop(bold(.(common)), 
                          atop(italic(.(x$scientificName[1])),
                               .(guid)))),
         cex.main=0.9)
    points(x[x$exclude, ], pch=20, cex=0.7, col='cornflowerblue')
    points(x[!x$exclude, ], pch=20, cex=0.7, col='red')
    plot(subset(aus_states, !grepl('Island', name)), border='#00000050', add=TRUE)
    dev.off()
  }
})
```

These shapefiles were then given to Linda Beaumont to clean manually. She then 
shared them on Google Drive [here](https://drive.google.com/open?id=0B68nAZY9cTa3Q2dQdklTbUxrY1U). 

These have been downloaded and are now in
'data/occurrence/chordata/shp_cleaned_by_linda/ALA animal occurrence data -
March2017 - shapefiles'. Majority have a consistent set of fields and are in
EPSG:3577, but some have a different set of fields, and are in WGS84 lonlat.

For some species, Linda added VBA data to the ALA data that she cleaned.

## Combine cleaned ALA (+VBA) with Bionet and data sourced by Janeen Robb

Read in Linda's cleaned data, species by species, and add the phase1_2016 data. 
We will ignore duplication, since we'll be reducing to 1 record per cell anyway.

```{r}
old_data <- readRDS(file.path('../sdms_1km_2016/data/occurrence',
                              'animal_occurrence_chordata_withJaneenData.rds'))

ff <- list.files(file.path(
  'data/occurrence/chordata/shp_cleaned_by_linda',
  'ALA animal occurrence data - March2017 - shapefiles'), '\\.shp$', full=TRUE)

# exclude koala for now... we don't have the bionet data handy
ff <- grep('Phascolarctos cinereus', ff, val=T, invert=T)

lapply(ff, function(f) {
  species2017 <- extension(basename(f), '')
  species2016 <- spp$phase1_2016[spp$phase1_2017==species2017]
  xy <- readOGR(f)
  xy <- xy[, c('id', 'mtchTCL', 'scntfcN', 'localty', 'crdnUIM', 'year', 
             'month', 'eventDt', 'bssOfRc', 'otlrFrL', 'txnIdnI', 'exclude', 
             'reason')]
  names(xy) <- c('record_id', 'lsid', 'scientific_name', 
                 'locality', 'coordinate_uncertainty',
                 'year', 'month', 'eventDate', 'basisOfRecord', 
                 'outlierForLayer', 'taxonIdentificationIssue', 
                 'exclude', 'reason')
  xy_old <- subset(old_data, scientific_name==species2016)
  stopifnot(grepl('aea', proj4string(xy_old)))
  if(!grepl('aea', proj4string(xy))) {
    xy <- spTransform(xy, CRS('+init=epsg:3577'))
  }
  suppressWarnings(proj4string(xy_old) <- CRS('+init=epsg:3577'))
  suppressWarnings(proj4string(xy) <- CRS('+init=epsg:3577'))
  xy_combined <- 
    rbind(xy_old[, c('record_id', 'scientific_name', 'coordinate_uncertainty', 'year')], 
          xy[xy$exclude==0, c('record_id', 'scientific_name', 'coordinate_uncertainty', 'year')])
  # drop records with duplicate record_id (retain any records with id = NA or '')
  xy_final <- xy_combined[!duplicated(xy_combined$record_id) | 
                            xy_combined$record_id=='' | 
                            is.na(xy_combined$record_id), ]
  writeOGR(xy_final, 
           'data/occurrence/chordata/shp_cleaned_by_linda_and_bionet_etc_added', 
           species2017, 'ESRI Shapefile')
})
```


## Re-download background data (Chordata)

For efficiency, we need to do this in two steps: (1) with
`fq='country:Australia'`, and (2) with `fq='-country=*'`. ALA is currently buggy
when attempting both filters at once.

Using ALA's offline download service, an email is sent to the specified email 
address once the download is ready. Depending on the download size, this can
take days.

```{r}
#occurrences(
#  'lsid:urn:lsid:biodiversity.org.au:afd.taxon:065f1da4-53cd-40b8-a396-80fa5c74dedd', 
#  record_count_only=T, fq=c('country:Australia'))
#
#occurrences(
#  'lsid:urn:lsid:biodiversity.org.au:afd.taxon:065f1da4-53cd-40b8-a396-80fa5c74dedd', 
#  record_count_only=T, fq=c('-country:*'))
#
#
#bg_chordata1 <- occurrences(
#  'lsid:urn:lsid:biodiversity.org.au:afd.taxon:065f1da4-53cd-40b8-a396-80fa5c74dedd', 
#  method='offline', email='john.baumgartner@mq.edu.au', download_reason_id=7,
#  fq='country:Australia')
#
#bg_chordata2 <- occurrences(
#  'lsid:urn:lsid:biodiversity.org.au:afd.taxon:065f1da4-53cd-40b8-a396-80fa5c74dedd', 
#  method='offline', email='john.baumgartner@mq.edu.au', download_reason_id=7,
#  fq='-country:*')


```

Reading backgroung for all chordata downloaded by John

```{r}
template <- raster(extent(c(-1887422.87658104, 2121577.12341896, 
                            -4865164.57704927, -1008164.57704927)),
                          res=c(1000, 1000),
                   crs='+init=epsg:3577')
bg <- readRDS('//Sci-7910/c/data/ALA/all_chordata_aus/all_chordata_aus_since1950_uncert1000maxOrMissing.rds') %>% 
  as.data.frame
coordinates(bg) <- ~lon+lat
proj4string(bg) <- '+init=epsg:4326'
bg <- spTransform(bg, CRS('+init=epsg:3577'))
bg_cells <- cellFromXY(template, bg)
# clean out duplicates and NAs (including points outside extent of predictor data)
bg_not_dupes <- which(!duplicated(bg_cells) & !is.na(bg_cells)) 
bg_unique <- xyFromCell(template, unique(bg_cells)) # reduce to unique cells and centre point in cell
rm(bg)
gc()
# If we wanted to weight background selection by density of records...
# n <- table(bg_cells)
# r <- template
# r[as.numeric(names(n))] <- n
# But we won't.

bg_unique_albers <- SpatialPoints(bg_unique, proj4string=CRS('+init=epsg:3577'))
#saveRDS(bg_unique_albers, '//sci-7910/c/data/ALA/all_chordata_aus/all_chordata_aus_since1950_uncert1000maxOrMissing.rds_uniquecells.rds')
bg_unique_albers <- readRDS('//sci-7910/c/data/ALA/all_chordata_aus/all_chordata_aus_since1950_uncert1000maxOrMissing.rds_uniquecells.rds')

```

```{r}
ff <- list.files('data/occurrence/chordata/shp_cleaned_by_linda_and_bionet_etc_added', 
                 '\\.shp$', full=TRUE, recursive=TRUE)
occ <- setNames(do.call(rbind, lapply(ff, readOGR)), 
              c('record_id', 'scientific_name', 'coordinates_uncertainty', 'year'))
saveRDS(occ, 'data/occurrence/chordata/shp_cleaned_by_linda_and_bionet_etc_added/occ_minimal_albers_chordata_phase1.rds')
```

